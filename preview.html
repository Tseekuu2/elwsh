<html translate="no">
<head>
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <script src="js/jquery.min.js"></script>
    <meta http-equiv="Content-Language" content="en">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Preview</title>
    <script src="js/fabric.min.js"></script>

    <script language="javascript">
        var offxf;
        var offyf;
        var contenidoaguardar = [];
        var contenidorellenado = [];
        var aciertos = 0;
        var errores = 0;
        var preguntas = 0;
        var clickedanswer = [];
        var grabando = 0;
        var pnt;
        var speechrecognitionenabledbrowser = 0;
        var speechsynthesisenabledbrowser = 0;
        var respuestascomprobadas = 0;
        var resizandoi = 0;
        var anorg = 0;
        var alorg = 0;
        var leorg = 0;
        var toorg = 0;
        var annu = 0;
        var alnu = 0;
        var tonu = 0;
        var lenu = 0;
        var oxf = 0;
        var oyf = 0;
        var dxf = 0;
        var dyf = 0;
        var arfi = 0;
        var flechaunida = [];
        var edstyln = 999999999;
        var ognr;
        var ognb;
        var ogng;
        var ogno;
        var ognff;
        var ognfs;
        var ognfc;
        var ognbc;
        var ognbw;
        var ognrc;
        var ognta;

        var nwr;
        var nwb;
        var nwg;
        var nwo;
        var nwff;
        var nwfs;
        var nwfc;
        var nwbc;
        var nwbw;
        var nwrc;
        var nwta;
        var editandostyletipo;

        var ignorarsignos = 0;
        var ignorarmayusculas = 1;
        var ignoraracentos = 0;

        var contenidojson = localStorage.getItem("contenidoaguardar");
        var imgElement = localStorage.getItem("base64")
        function imgLoading(){
            console.log(imgElement)
            console.log(contenidojson)
            document.getElementById("imagendefondo1").src = imgElement;
        }
        function mostrarcontenido() {

            // localStorage дотор байгаа зүйлсийг авч preview дээр зурах хэсэг
            offxf = document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetLeft;
            offyf = document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetTop;
            contenidoaguardar = JSON.parse(contenidojson);
            contenidorellenado = JSON.parse(contenidojson);

            rellenarHtml();

        }


        function arreglarTextoparaguardar(eltexto) {
            var textvalue = eltexto;
            //<br> аар солих хэсэг
            textvalue = textvalue.replace(/(?:\r\n|\r|\n)/g, '<br>');
            textvalue = textvalue.replace(/\t/g, ' ');
            textvalue = textvalue.split("'").join("$");
            textvalue = textvalue.split('"').join("#");
            textvalue = textvalue.replace(/\\/g, "/");
            return textvalue;
        }


        function arreglarTexto(eltexto) {
            //textvalue = eltexto.toLowerCase();
            textvalue = eltexto;
            //textvalue = textvalue.trim();
            textvalue = textvalue.split("´").join("'");
            textvalue = textvalue.split("’").join("'");
            textvalue = textvalue.split("‘").join("'");
            textvalue = textvalue.split("&nbsp;").join(" ");
            textvalue = textvalue.split("<br>").join(" ");
            textvalue = textvalue.split("\n").join(" ");
            //textvalue = textvalue.split("  ").join(" "); //давхар зайг дан зайгаар солино
            textvalue = textvalue.replace(/\s\s+/g, ' ');
            textvalue = textvalue.split("/ ").join("/");
            textvalue = textvalue.split(" /").join("/");
            textvalue = textvalue.split("./").join("/");
            textvalue = textvalue.split(" /").join("/");
            textvalue = textvalue.split("/* ").join("/*");
            textvalue = textvalue.split("'").join("$");
            textvalue = textvalue.split('"').join("#");
            textvalue = textvalue.split(' :').join(":");
            textvalue = textvalue.split(' ,').join(",");
            textvalue = textvalue.split(' .').join(".");
            textvalue = textvalue.split(' ;').join(";");
            textvalue = textvalue.split(': ').join(":");
            textvalue = textvalue.split(', ').join(",");
            textvalue = textvalue.split('. ').join(".");
            textvalue = textvalue.split('; ').join(";");
            textvalue = textvalue.split("  ").join(" ");
            textvalue = textvalue.split("( ").join("(");
            textvalue = textvalue.split(" )").join(")");
            textvalue = textvalue.split("´").join("'");
            textvalue = textvalue.split("’").join("'");
            textvalue = textvalue.split("‘").join("'");
            textvalue = textvalue.replace(/\\/g, "/");
            textvalue = textvalue.replace(/\( transparent/ig, "(transparent");
            textvalue = textvalue.replace(/transparent \)/ig, "transparent)");
            textvalue = textvalue.replace("(transparent) ", "(transparent)");
            textvalue = textvalue.replace("(transparent)", "");
            textvalue = textvalue.replace(/\(rate:.*?\)/, '');

            // textvalue = textvalue.replace(/playmp3:/ig, 'playmp3:');
            textvalue = textvalue.replace(/join:/ig, 'join:');
            textvalue = textvalue.replace(/drag:/ig, 'drag:');
            textvalue = textvalue.replace(/drop:/ig, 'drop:');
            textvalue = textvalue.replace(/choose:/ig, 'choose:');
            textvalue = textvalue.replace(/select:/ig, 'select:');
            textvalue = textvalue.replace(/tick:/ig, 'tick:');
            textvalue = textvalue.replace(/link:/ig, 'link:');
            textvalue = textvalue.replace(/speak:/ig, 'speak:');
            textvalue = textvalue.replace(/listen:/ig, 'listen:');
            textvalue = textvalue.replace(/value:/ig, 'value:');

            textvalue = textvalue.replace("select: ", "select:");
            textvalue = textvalue.replace("tick: ", "tick:");
            textvalue = textvalue.replace("choose: ", "choose:");
            // textvalue = textvalue.replace("speak: ", "speak:");
            // textvalue = textvalue.replace("listen: ", "listen:");
            textvalue = textvalue.replace("drag: ", "drag:");
            textvalue = textvalue.replace("drop: ", "drop:");
            textvalue = textvalue.replace("join: ", "join:");
            textvalue = textvalue.replace("link: ", "link:");
            // textvalue = textvalue.replace("playmp3: ", "playmp3:");
            textvalue = textvalue.replace("value: ", "value:");


            //hacemos trim
            textvalue = textvalue.replace(/^\s*|\s*$/g, "");

            //quitamos los puntos finales
            if (textvalue.length > 1) {
                textvalue = textvalue.replace(/\s*[.]$/g, "");
            }
            return textvalue;
        }


        function eliminarsignos(eltexto) {
            textvalue = eltexto;
            textvalue = textvalue.split("?").join(" ");
            textvalue = textvalue.split("¿").join(" ");
            textvalue = textvalue.split(",").join(" ");
            textvalue = textvalue.split(".").join(" ");
            textvalue = textvalue.split(";").join(" ");
            textvalue = textvalue.split(":").join(" ");
            textvalue = textvalue.split("-").join(" ");
            textvalue = textvalue.split("(").join(" ");
            textvalue = textvalue.split(")").join(" ");
            textvalue = textvalue.split("¡").join(" ");
            textvalue = textvalue.split("!").join(" ");
            //hacemos trim
            textvalue = textvalue.replace(/^\s*|\s*$/g, "");
            //sustituye espacios dobles por simples
            textvalue = textvalue.replace(/\s\s+/g, ' ');
            return textvalue;
        }


        function eliminaracentos(eltexto) {
            textvalue = eltexto;
            textvalue = textvalue.split("á").join("a");
            textvalue = textvalue.split("é").join("e");
            textvalue = textvalue.split("í").join("i");
            textvalue = textvalue.split("ó").join("o");
            textvalue = textvalue.split("ú").join("u");
            textvalue = textvalue.split("à").join("a");
            textvalue = textvalue.split("è").join("e");
            textvalue = textvalue.split("ì").join("i");
            textvalue = textvalue.split("ò").join("o");
            textvalue = textvalue.split("ù").join("u");
            textvalue = textvalue.split("ä").join("a");
            textvalue = textvalue.split("ë").join("e");
            textvalue = textvalue.split("ï").join("i");
            textvalue = textvalue.split("ö").join("o");
            textvalue = textvalue.split("ü").join("u");
            textvalue = textvalue.split("â").join("a");
            textvalue = textvalue.split("ê").join("e");
            textvalue = textvalue.split("î").join("i");
            textvalue = textvalue.split("ô").join("o");
            textvalue = textvalue.split("û").join("u");
            return textvalue;
        }


        function pegarTexto(eltexto) {
            var textvalue = eltexto;
            if (textvalue.length > 0) {
                textvalue = textvalue.split("$").join("'");
                textvalue = textvalue.split("#").join('"');
            }
            return textvalue;
        }


        function validateYouTubeUrl(enlace) {

            if (enlace != undefined || enlace != '') {
                var regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|\?v=)([^#\&\?]*).*/;
                var match = enlace.match(regExp);
                if (match && match[2].length == 11) {
                    // Do anything for being valid
                    // if need to change the url to embed url then use below line
                    return match[2];
                } else {
                    return "";
                }
            } else {
                return "";
            }
        }


        function validarSoundcloud(enlace) {
            if (enlace.indexOf("{iframe") == 0) {
                separarsource = enlace.split('src="');
                if (separarsource.length == 2) {
                    if (separarsource[1].indexOf("https://w.soundcloud.com") == 0) {
                        separarfuente = separarsource[1].split('"');
                        if (separarfuente.length > 1) {
                            return separarfuente[0];
                        } else {
                            return "";
                        }
                    } else {
                        return "";
                    }
                } else {
                    return "";
                }
            } else {
                return "";
            }
        }


        //reproductor de audio personalizado xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
        var onplayhead = -1;


        function mp3player(numero) {
            var timelineWidth;
            var audioplayer = document.getElementById('audioplayer' + numero);
            var music = document.getElementById('music' + numero); // id for audio element
            var duration = music.duration; // Duration of audio clip, calculated here for embedding purposes
            var pButton = document.getElementById('pButton' + numero); // play button
            var playhead = document.getElementById('playhead' + numero); // playhead
            var timeline = document.getElementById('timeline' + numero); // timeline

            if (audioplayer.offsetHeight > 30) {
                pButton.style.height = "30px";
                pButton.style.width = "30px";
                pButton.style.marginTop = parseInt((audioplayer.offsetHeight - 30) / 2) + "px";
                timeline.style.height = "15px";
                timeline.style.marginTop = parseInt((audioplayer.offsetHeight - 15) / 2) + "px";
                playhead.style.height = "15px";
                playhead.style.width = "15px";
            } else {
                pButton.style.height = "20px";
                pButton.style.width = "20px";
                pButton.style.marginTop = parseInt((audioplayer.offsetHeight - 20) / 2) + "px";
                timeline.style.height = "10px";
                timeline.style.marginTop = parseInt((audioplayer.offsetHeight - 10) / 2) + "px";
                playhead.style.height = "10px";
                playhead.style.width = "10px";
            }

            //if (audioplayer.offsetWidth < 150) {
            //timeline.style.width = (150 - pButton.offsetWidth - 10) + "px";
            //} else {
            timeline.style.width = (audioplayer.offsetWidth - pButton.offsetWidth - 10) + "px";
            //}

            //si el player es estrecho, escondo el timeline con marginleft para que quede en overflow
            if (audioplayer.offsetWidth < 80) {
                timeline.style.marginLeft = "80px";
            }


        }

        function play(numero) {
            if (document.getElementById('music' + numero).paused || document.getElementById('music' + numero).ended) {
                document.getElementById('music' + numero).play();
                document.getElementById('pButton' + numero).style.backgroundImage = "url(https://files.liveworksheets.com/images/pause.png)";
            } else {
                document.getElementById('music' + numero).pause();
                document.getElementById('pButton' + numero).style.backgroundImage = "url(https://files.liveworksheets.com/images/play.png)";
            }
        }


        function playtransparent(numero) {
            if (document.getElementById('music' + numero).paused || document.getElementById('music' + numero).ended) {
                document.getElementById('music' + numero).play();
            } else {
                document.getElementById('music' + numero).pause();
            }
        }


        function timeUpdate(numero, alturaoriginal, anchuraoriginal) {
            if (onplayhead == -1) {
                var timelineWidth = document.getElementById('timeline' + numero).offsetWidth - document.getElementById('playhead' + numero).offsetWidth;
                var playPercent = timelineWidth * (document.getElementById('music' + numero).currentTime / document.getElementById('music' + numero).duration);
                document.getElementById('playhead' + numero).style.marginLeft = playPercent + "px";
                if (document.getElementById('music' + numero).currentTime == document.getElementById('music' + numero).duration) {
                    document.getElementById('pButton' + numero).style.backgroundImage = "url(https://files.liveworksheets.com/images/play.png)";
                    document.getElementById('audioplayer' + numero).style.width = anchuraoriginal + "px";
                    document.getElementById('audioplayer' + numero).style.height = alturaoriginal + "px";
                }
            }
        }

        function mouseDown(numero) {
            onplayhead = numero;
            window.addEventListener('mousemove', moveplayhead, true);
            window.addEventListener('mouseup', mouseUp, false);
        }


        function moveplayhead(event) {

            if (onplayhead > -1) {
                var numero = onplayhead;
                var timelineWidth = document.getElementById('timeline' + numero).offsetWidth - document.getElementById('playhead' + numero).offsetWidth;
                var newMargLeft = event.clientX - document.getElementById('timeline' + numero).getBoundingClientRect().left;
                if (newMargLeft >= 0 && newMargLeft <= timelineWidth) {
                    document.getElementById('playhead' + numero).style.marginLeft = newMargLeft + "px";
                }
                if (newMargLeft < 0) {
                    document.getElementById('playhead' + numero).style.marginLeft = "0px";
                }
                if (newMargLeft > timelineWidth) {
                    document.getElementById('playhead' + numero).style.marginLeft = timelineWidth + "px";
                }
            }
        }


        function mouseUp(event) {
            if (onplayhead > -1) {
                var numero = onplayhead;
                moveplayhead(event);
                window.removeEventListener('mousemove', moveplayhead, true);
                document.getElementById('music' + numero).currentTime = document.getElementById('music' + numero).duration * clickPercent(event);
                onplayhead = -1;
            }
        }


        function clickPercent(event) {
            if (onplayhead > -1) {
                var numero = onplayhead;
                var timelineWidth = document.getElementById('timeline' + numero).offsetWidth - document.getElementById('playhead' + numero).offsetWidth;
                return (event.clientX - document.getElementById('timeline' + numero).getBoundingClientRect().left) / timelineWidth;
            }
        }


        function clickedTimeline(numero) {
            onplayhead = numero;
        }

        function clickTimeline(event) {
            if (onplayhead > -1) {
                var numero = onplayhead;
                moveplayhead(event);
                document.getElementById('music' + numero).currentTime = document.getElementById('music' + numero).duration * clickPercent(event);
                onplayhead = -1;
            }
        }


        //fin reproductor de audio personalizado xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx


        function rellenarHtml() {
            var innerhtmlcapacanvas2 = '<svg id="elsvgdefinitivo" width="1000" height="1411">';
            for (var j = 0; j < contenidoaguardar.length; j++) {

                if (contenidoaguardar[j].length > (12 - 5)) {
                    fontfamily = contenidoaguardar[j][12 - 5];
                } else {
                    fontfamily = "Arial"
                }
                if (contenidoaguardar[j].length > (12 - 4)) {
                    fontsize = contenidoaguardar[j][12 - 4] + "px";
                } else {
                    fontsize = "14px"
                }
                if (contenidoaguardar[j].length > (12 - 3)) {
                    fontcolor = "#" + contenidoaguardar[j][12 - 3];
                } else {
                    fontcolor = "#0000CC"
                }
                if (contenidoaguardar[j].length > (12 + 1)) {
                    backgroundcolor = 'rgba(' + contenidoaguardar[j][12 - 2] + ', ' + contenidoaguardar[j][12 - 1] + ', ' + contenidoaguardar[j][12] + ', ' + contenidoaguardar[j][12 + 1] + ')';
                } else {
                    backgroundcolor = "rgba(255,255,255,0.5)"
                }
                if (contenidoaguardar[j].length > (12 + 2)) {
                    bordercolor = "#" + contenidoaguardar[j][12 + 2];
                } else {
                    bordercolor = "#C0C0C0"
                }
                if (contenidoaguardar[j].length > (12 + 5)) {
                    borderwidth = contenidoaguardar[j][12 + 5] + "px";
                } else {
                    borderwidth = "1px"
                }
                if (contenidoaguardar[j].length > (12 + 6)) {
                    roundedcorners = contenidoaguardar[j][12 + 6] + "px";
                } else {
                    roundedcorners = "4px"
                }
                if (contenidoaguardar[j].length > (12 + 3)) {
                    if (contenidoaguardar[j][12 + 3] !== null) {
                        if (contenidoaguardar[j][12 + 3].length > 1) {
                            alineacion = contenidoaguardar[j][12 + 3];
                        } else {
                            alineacion = "center";
                        }
                    } else {
                        alineacion = "center";
                    }
                } else {
                    alineacion = "center";
                }
                flechaunida[j] = "";
                texto = arreglarTexto(contenidoaguardar[j][0]);


                if (texto.indexOf("wordsearch(") == 0) {
                    var separarlosdospuntos = texto.split(":");
                    var rowsandcolumns = separarlosdospuntos[1];
                    if (contenidorellenado[j][5].length < rowsandcolumns.length) {
                        contenidorellenado[j][5] = rowsandcolumns.split("v").join("x");
                    }
                    var separarelnumerodecolumnas = separarlosdospuntos[0].split("x");
                    var elnumerodecolumnas = Number(separarelnumerodecolumnas[1].replace(")", ""));
                    var numerodecolumna = 0;
                    var htmltable = '<table class="wordsearchtable">';
                    for (var k = 0; k < rowsandcolumns.length; k++) {
                        if (numerodecolumna == 0) {
                            htmltable = htmltable + '<tr>';
                        }
                        if (contenidorellenado[j][5].charAt(k) == "v") {
                            htmltable = htmltable + '<td id="td' + j + '-' + k + '" class="clickedtd" onclick="clickwordsearchtd(this,' + j + ',' + k + ')"></td>';
                        } else {
                            htmltable = htmltable + '<td id="td' + j + '-' + k + '" class="wordsearchtd" onclick="clickwordsearchtd(this,' + j + ',' + k + ')"></td>';
                        }
                        numerodecolumna = numerodecolumna + 1;
                        if (numerodecolumna == elnumerodecolumnas) {
                            htmltable = htmltable + '</tr>';
                            numerodecolumna = 0;
                        }

                    }
                    htmltable = htmltable + '</table>';
                    nuevohtml = '<div class="wordsearchdiv" id="wordsearchbox' + j + '"  style="z-index:4;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;font-size:14px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px">' + htmltable + '</div>';
                    document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                } else if (texto.indexOf("choose:") == 0) {
                    textoopciones = texto.replace("choose:", "");
                    opciones = textoopciones.split("/");
                    htmlopciones = '<option>   </option>';
                    for (var k = 0; k < opciones.length; k++) {
                        if (k + 1 == parseInt(contenidoaguardar[j][5])) {
                            lastring = " selected>";
                        } else {
                            lastring = ">";
                        }
                        if (opciones[k].indexOf("*") == 0) {
                            htmlopciones = htmlopciones + '<option value="right"' + lastring + pegarTexto(opciones[k].substring(1)) + '</option>';
                        } else {
                            htmlopciones = htmlopciones + '<option' + lastring + pegarTexto(opciones[k]) + '</option>';
                        }
                    }
                    nuevohtml = '<select ' + 'c' + 'l' + 'a' + 's' + 's' + '="' + 's' + 'e' + 'l' + 'e' + 'c' + 't' + 'b' + 'o' + 'x' + '" ' + 'o' + 'n' + 'c' + 'o' + 'n' + 't' + 'e' + 'x' + 't' + 'm' + 'e' + 'n' + 'u' + '="' + 's' + 'h' + 'o' + 'w' + 's' + 't' + 'y' + 'l' + 'e' + 'c' + 'h' + 'o' + 'o' + 's' + 'e' + '(' + j + ',' + (Number(contenidoaguardar[j][1]) + Number(contenidoaguardar[j][3])) + ',' + contenidoaguardar[j][2] + ',\'selectbox\');return false;" name="' + 's' + 'e' + 'l' + 'e' + 'c' + 't' + 'b' + 'o' + 'x' + j + '" id="' + 's' + 'e' + 'l' + 'e' + 'c' + 't' + 'b' + 'o' + 'x' + j + '" onblur="' + 's' + 'a' + 'v' + 'e' + 's' + 'e' + 'l' + 'e' + 'c' + 't' + 'box(' + j + ')" style="z-index:4;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px;font-family:' + fontfamily + ';font-size:' + fontsize + ';color:' + fontcolor + ';background-color:' + backgroundcolor + ';border-width:' + borderwidth + ';border-color:' + bordercolor + ';border-radius:' + roundedcorners + '">' + htmlopciones + '</select>';
                    document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                } else if (texto.indexOf('l' + 'i' + 'n' + 'k' + ":") == 0) {
                    var urlenlace = texto.replace("link:", "");
                    urlenlace = urlenlace.replace("LINK:", "");
                    urlenlace = urlenlace.replace("Link:", "");
                    urlenlace = urlenlace.trim();
                    urlenlace = 'http://' + urlenlace;
                    urlenlace = urlenlace.replace("http://http://", "http://");
                    urlenlace = urlenlace.replace("http://https://", "https://");
                    urlenlace = urlenlace.replace("http://HTTP://", "http://");
                    urlenlace = urlenlace.replace("http://HTTPS://", "https://");
                    nuevohtml = '<a href="' + urlenlace + '" target="_blank" rel="nofollow"><div ' + 'c' + 'l' + 'a' + 's' + 's' + '="selectablediv" id="' + 'l' + 'i' + 'n' + 'k' + 'd' + 'i' + 'v' + j + '"  style="z-index:4;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;font-size:14px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px"></div></a>';
                    document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                } else if (texto.indexOf('s' + 'e' + 'l' + 'e' + 'c' + 't' + ":") == 0) {
                    if (contenidoaguardar[j][5] == 'yes') {
                        nuevohtml = '<div ' + 'c' + 'l' + 'a' + 's' + 's' + '="' + 's' + 'e' + 'l' + 'e' + 'c' + 't' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + '" id="' + 's' + 'e' + 'l' + 'e' + 'c' + 't' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j + '"  style="z-index:4;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;font-size:14px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px"></div>';
                        document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                        clickedanswer[j] = "yes";
                    } else {

                        nuevohtml = '<div ' + 'c' + 'l' + 'a' + 's' + 's' + '="' + 's' + 'e' + 'l' + 'e' + 'c' + 't' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + '" id="' + 's' + 'e' + 'l' + 'e' + 'c' + 't' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j + '"  style="z-index:4;cursor:pointer;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;font-size:14px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px" ' + 'o' + 'n' + 'c' + 'l' + 'i' + 'c' + 'k' + '="' + 's' + 'e' + 'l' + 'e' + 'c' + 't' + 'a' + 'n' + 's' + 'w' + 'e' + 'r' + '(' + j + ')"></div>';
                        document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);

                        clickedanswer[j] = "no";
                    }
                } else if (texto.indexOf('tick:') == 0) {
                    var dimensionmenor = Number(contenidoaguardar[j][4]);
                    if (Number(contenidoaguardar[j][3]) < dimensionmenor) {
                        dimensionmenor = Number(contenidoaguardar[j][3]);
                    }
                    dimensionmenor = Math.floor(dimensionmenor / 4) * 4;
                    if (contenidoaguardar[j][5] == 'yes') {
                        nuevohtml = '<div class="tickbox" id="tickbox' + j + '"  style="z-index:4;width:' + dimensionmenor + 'px;height:' + dimensionmenor + 'px;font-size:' + dimensionmenor + 'px;line-height:' + dimensionmenor + 'px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px">✓</div>';
                        document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                        clickedanswer[j] = "yes";
                    } else {
                        nuevohtml = '<div class="tickbox" id="tickbox' + j + '"  style="z-index:4;cursor:pointer;width:' + dimensionmenor + 'px;height:' + dimensionmenor + 'px;font-size:' + dimensionmenor + 'px;line-height:' + dimensionmenor + 'px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px" onclick="tickanswer(' + j + ')"></div>';
                        document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                        clickedanswer[j] = "no";
                    }
                } else if (texto.indexOf('s' + 'p' + 'e' + 'a' + 'k' + "(") == 0) {
                    lenguajeelegido = "'" + texto.substring(texto.indexOf("(") + 1, texto.indexOf("):")) + "'";
                    nuevohtml = '<div ' + 'c' + 'l' + 'a' + 's' + 's' + '="' + 'e' + 'd' + 'i' + 't' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + '" ' + 'o' + 'n' + 'c' + 'o' + 'n' + 't' + 'e' + 'x' + 't' + 'm' + 'e' + 'n' + 'u' + '="' + 's' + 'h' + 'o' + 'w' + 's' + 't' + 'y' + 'l' + 'e' + 'c' + 'h' + 'o' + 'o' + 's' + 'e' + '(' + j + ',' + (Number(contenidoaguardar[j][1]) + Number(contenidoaguardar[j][3])) + ',' + contenidoaguardar[j][2] + ',\'speakbox\');return false;" ' + 'o' + 'n' + 'b' + 'l' + 'u' + 'r' + '="' + 's' + 'a' + 'v' + 'e' + 't' + 'e' + 'x' + 't' + 'b' + 'o' + 'x' + '(' + j + ')" id="' + 's' + 'p' + 'e' + 'a' + 'k' + 'b' + 'o' + 'x' + j + '"  style="z-index:4;width:' + (parseInt(contenidoaguardar[j][4]) - 15) + 'px;height:' + contenidoaguardar[j][3] + 'px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px;font-family:' + fontfamily + ';font-size:' + fontsize + ';color:' + fontcolor + ';background-color:' + backgroundcolor + ';border-width:' + borderwidth + ';border-color:' + bordercolor + ';border-radius:' + roundedcorners + '">' + pegarTexto(contenidoaguardar[j][5]) + '</div><div id="microfono' + j + '" style="z-index:5;cursor:pointer;width:30px;height:30px;position:absolute;top:' + (parseInt(contenidoaguardar[j][1]) + (parseInt(contenidoaguardar[j][3]) / 2) - 15) + 'px;left:' + (parseInt(contenidoaguardar[j][2]) + parseInt(contenidoaguardar[j][4]) - 30) + 'px" ' + 'o' + 'n' + 'c' + 'l' + 'i' + 'c' + 'k' + '="' + 's' + 'p' + 'e' + 'e' + 'c' + 'h' + 'R' + 'e' + 'c' + 'o' + 'g' + 'n' + 'i' + 't' + 'i' + 'o' + 'n' + '(' + j + ',' + String(lenguajeelegido) + ')"><img src="https://files.liveworksheets.com/images/microfono.png" title="Click and speak" alt="Click and speak"><div>';
                    document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                } else if (validateYouTubeUrl(contenidoaguardar[j][0]).length > (12 - 11)) {

                    nuevohtml = '<div  id="' + 'y' + 'o' + 'u' + 't' + 'u' + 'b' + 'e' + 'i' + 'f' + 'r' + 'a' + 'm' + 'e' + j + '"   style="z-index:4;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px"><iframe width="' + contenidoaguardar[j][4] + '" height="' + contenidoaguardar[j][3] + '" src="https://www.youtube-nocookie.com/embed/' + validateYouTubeUrl(contenidoaguardar[j][0]) + '?rel=0&amp;showinfo=0&amp;cc_load_policy=3" frameborder="0"></iframe>';

                    if (contenidoaguardar[j][4] > 320) {
                        nuevohtml = nuevohtml + '<div style="width:230px;height:36px;position:absolute;z-index:2;bottom:0px;right:0px" ></div>';
                    }
                    if (contenidoaguardar[j][3] > 220) {
                        nuevohtml = nuevohtml + '<div style="width:' + contenidoaguardar[j][4] + 'px;height:70px;position:absolute;z-index:2;top:0px;left:0px" ></div>';
                    }
                    nuevohtml = nuevohtml + '</div>';
                    document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                } else if (contenidoaguardar[j][0].indexOf('https://onedrive.live.com/embed?') == 0) {
                    nuevohtml = '<div  id="powerpointiframe' + j + '"   style="z-index:4;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px"><iframe width="' + contenidoaguardar[j][4] + '" height="' + contenidoaguardar[j][3] + '" src="' + contenidoaguardar[j][0] + '" frameborder="0"></iframe></div>';
                    document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                } else if (texto.indexOf('d' + 'r' + 'a' + 'g' + ":") == 0) {
                    var offsetArriba = 0;
                    var imagendefinitiva = 1;
                    for (var w = 1; w < 2; w++) {
                        if (contenidoaguardar[j][1] > document.getElementById('i' + 'm' + 'a' + 'g' + 'e' + 'n' + 'd' + 'e' + 'f' + 'o' + 'n' + 'd' + 'o' + w).offsetTop) {
                            offsetArriba = document.getElementById('i' + 'm' + 'a' + 'g' + 'e' + 'n' + 'd' + 'e' + 'f' + 'o' + 'n' + 'd' + 'o' + w).offsetTop;
                            imagendefinitiva = w;
                        }
                    }
                    offsetdelfondo = contenidoaguardar[j][1] - offsetArriba;
                    nuevohtml = '<div ' + 'd' + 'r' + 'a' + 'g' + 'g' + 'a' + 'b' + 'l' + 'e' + '="' + 'f' + 'a' + 'l' + 's' + 'e' + '" ' + 'c' + 'l' + 'a' + 's' + 's' + '="' + 'b' + 'l' + 'a' + 'n' + 'k' + 'd' + 'i' + 'v' + '" id="' + 'b' + 'l' + 'a' + 'n' + 'k' + 'd' + 'i' + 'v' + j + '"  style="z-index:4;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px;background-color: #FFFFFF"></div>';
                    document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                    if (contenidoaguardar[j][5].length > 0) {
                        separareltopyelright = contenidoaguardar[j][5].split("@");
                        nuevohtml = '<div ' + 'd' + 'r' + 'a' + 'g' + 'g' + 'a' + 'b' + 'l' + 'e' + '="' + 'f' + 'a' + 'l' + 's' + 'e' + '" ' + 'c' + 'l' + 'a' + 's' + 's' + '="' + 'd' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + '" id="' + 'd' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j + '"  style="touch-action:none;z-index:5;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;position:absolute;top:' + separareltopyelright[0] + 'px;left:' + separareltopyelright[1] + 'px;background-position:-' + contenidoaguardar[j][2] + 'px -' + offsetdelfondo + 'px;background-image: url(' + imgElement + ')"></div>';
                        document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                    } else {
                        nuevohtml = '<div ' + 'd' + 'r' + 'a' + 'g' + 'g' + 'a' + 'b' + 'l' + 'e' + '="' + 'f' + 'a' + 'l' + 's' + 'e' + '" ' + 'c' + 'l' + 'a' + 's' + 's' + '="' + 'd' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + '" id="' + 'd' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j + '"  style="touch-action:none;z-index:5;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px;background-position:-' + contenidoaguardar[j][2] + 'px -' + offsetdelfondo + 'px;background-image: url(' + imgElement + ');cursor:move" ' + 'o' + 'n' + 'm' + 'o' + 'u' + 's' + 'e' + 'd' + 'o' + 'w' + 'n' + '="' + 'd' + 'r' + 'g' + 't' + 'b' + '(' + j + ')" ' + 'o' + 'n' + 't' + 'o' + 'u' + 'c' + 'h' + 's' + 't' + 'a' + 'r' + 't' + '="' + 'd' + 'r' + 'g' + 't' + 'b' + 't' + '(' + j + ')" ></div>';
                        document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                    }
                } else if (texto.indexOf('d' + 'r' + 'o' + 'p' + ":") == 0) {
                    nuevohtml = '<div ' + 'd' + 'r' + 'a' + 'g' + 'g' + 'a' + 'b' + 'l' + 'e' + '="' + 'f' + 'a' + 'l' + 's' + 'e' + '" ' + 'c' + 'l' + 'a' + 's' + 's' + '="' + 'd' + 'r' + 'o' + 'p' + 'd' + 'i' + 'v' + '" id="' + 'd' + 'r' + 'o' + 'p' + 'd' + 'i' + 'v' + j + '"  style="z-index:4;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px"></div>';
                    document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                } else if (texto.indexOf('j' + 'o' + 'i' + 'n' + ":") == 0) {
                    nuevohtml = '<div ' + 'd' + 'r' + 'a' + 'g' + 'g' + 'a' + 'b' + 'l' + 'e' + '="' + 'f' + 'a' + 'l' + 's' + 'e' + '" ' + 'c' + 'l' + 'a' + 's' + 's' + '="' + 'j' + 'o' + 'i' + 'n' + 'd' + 'i' + 'v' + '" id="' + 'j' + 'o' + 'i' + 'n' + 'd' + 'i' + 'v' + j + '"  style="touch-action:none;z-index:4;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px" on' + 'm' + 'o' + 'u' + 's' + 'e' + 'down="' + 's' + 't' + 'a' + '(' + j + ')" ' + 'o' + 'n' + 't' + 'o' + 'u' + 'c' + 'h' + 's' + 't' + 'a' + 'r' + 't' + '="' + 's' + 't' + 'a' + 't' + '(' + j + ')"></div>';
                    document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                    if (contenidorellenado[j][5].length > 0) {
                        innerhtmlcapacanvas2 = innerhtmlcapacanvas2 + contenidoaguardar[j][5].split('#').join('"');
                    }
                } else if (texto.indexOf('print:') == 0) {
                    texttoprint = pegarTexto(texto.replace("print:", ""));
                    nuevohtml = '<div class="printboxdiv" ' + 'o' + 'n' + 'c' + 'o' + 'n' + 't' + 'e' + 'x' + 't' + 'm' + 'e' + 'n' + 'u' + '="' + 's' + 'h' + 'o' + 'w' + 's' + 't' + 'yl' + 'e' + 'c' + 'h' + 'o' + 'o' + 's' + 'e' + '(' + j + ',' + (Number(contenidoaguardar[j][1]) + Number(contenidoaguardar[j][3])) + ',' + contenidoaguardar[j][2] + ',\'printbox\');return false;" id="printbox' + j + '" style="z-index:4;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px;font-family:' + fontfamily + ';font-size:' + fontsize + ';color:' + fontcolor + ';background-color:' + backgroundcolor + ';border-width:' + borderwidth + ';border-color:' + bordercolor + ';border-radius:' + roundedcorners + ';text-align:' + alineacion + '">' + texttoprint + '</div>';
                    document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                } else if (texto.indexOf('value:') == 0) {

                } else {
                    nuevohtml = '<div spellcheck="false" autocomplete="off" ' + 'c' + 'l' + 'a' + 's' + 's' + '="' + 'e' + 'd' + 'i' + 't' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + '" ' + 'o' + 'n' + 'c' + 'o' + 'n' + 't' + 'e' + 'x' + 't' + 'm' + 'e' + 'n' + 'u' + '="' + 's' + 'h' + 'o' + 'w' + 's' + 't' + 'yl' + 'e' + 'c' + 'h' + 'o' + 'o' + 's' + 'e' + '(' + j + ',' + (Number(contenidoaguardar[j][1]) + Number(contenidoaguardar[j][3])) + ',' + contenidoaguardar[j][2] + ',\'textbox\');return false;" ' + 'o' + 'n' + 'b' + 'l' + 'u' + 'r' + '="' + 's' + 'a' + 'v' + 'e' + 't' + 'e' + 'x' + 't' + 'b' + 'o' + 'x' + '(' + j + ')" contenteditable="true" id="' + 't' + 'e' + 'x' + 't' + 'b' + 'o' + 'x' + j + '"  style="z-index:4;width:' + contenidoaguardar[j][4] + 'px;height:' + contenidoaguardar[j][3] + 'px;position:absolute;top:' + contenidoaguardar[j][1] + 'px;left:' + contenidoaguardar[j][2] + 'px;font-family:' + fontfamily + ';font-size:' + fontsize + ';color:' + fontcolor + ';background-color:' + backgroundcolor + ';border-width:' + borderwidth + ';border-color:' + bordercolor + ';border-radius:' + roundedcorners + ';text-align:' + alineacion + '">' + pegarTexto(contenidoaguardar[j][5]) + '</div>';
                    document.getElementById('capa1').insertAdjacentHTML('beforeend', nuevohtml);
                }
            }

            document.getElementById("capacanvas2").innerHTML = innerhtmlcapacanvas2 + '</svg>';

            var dragabledivclass = document.getElementsByClassName("dragablediv");
            for (var i = 0; i < dragabledivclass.length; i++) {
                if (dragabledivclass[i].style.cursor == "move") {
                    dragabledivclass[i].addEventListener("touchstart", drgtbt, {passive: false});
                }
            }

            var joindivclass = document.getElementsByClassName("joindiv");
            for (var i = 0; i < joindivclass.length; i++) {
                joindivclass[i].addEventListener("touchstart", stat, {passive: false});
            }

        }

        function clickwordsearchtd(item, numero, numerotd) {
            if (contenidorellenado[numero][5].charAt(numerotd) == "v") {
                contenidorellenado[numero][5] = contenidorellenado[numero][5].substring(0, numerotd) + "x" + contenidorellenado[numero][5].substring(numerotd + 1);
                item.setAttribute("class", "wordsearchtd");
            } else {
                contenidorellenado[numero][5] = contenidorellenado[numero][5].substring(0, numerotd) + "v" + contenidorellenado[numero][5].substring(numerotd + 1);
                item.setAttribute("class", "clickedtd");
            }
        }


        function sta(numero) {
            if (respuestascomprobadas == 0) {
                arfi = numero;
                document.addEventListener('m' + 'o' + 'u' + 's' + 'e' + 'm' + 'o' + 'v' + 'e', arf, false);
                document.addEventListener('m' + 'o' + 'u' + 's' + 'e' + 'u' + 'p', farf, false);
            }
        }


        function stat(event) {
            event.preventDefault();
            if (event.target.id.indexOf("joindiv") > -1) {

                elnumero = event.target.id.replace("joindiv", "");

                if (elnumero.length > 0) {
                    if (isNaN(elnumero)) {

                    } else {
                        numero = parseInt(elnumero);
                        if (respuestascomprobadas == 0) {
                            arfi = numero;

                            document.addEventListener('t' + 'o' + 'u' + 'c' + 'h' + 'm' + 'o' + 'v' + 'e', arft, {passive: false});
                            document.addEventListener('t' + 'o' + 'u' + 'c' + 'h' + 'e' + 'n' + 'd', farft, {passive: false});
                        }
                    }
                }
            }
        }


        function arft(event) {
            var touch = event.targetTouches[0];
            if (oxf == 0) {
                oxf = touch.pageX - parseInt(document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetLeft);
            }
            if (oyf == 0) {
                oyf = touch.pageY - parseInt(document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetTop);
            }
            dxf = touch.pageX - parseInt(document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetLeft);
            dyf = touch.pageY - parseInt(document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetTop);
            document.getElementById('e' + 'l' + 's' + 'v' + 'g').innerHTML = '<line x1="' + oxf + '" y1="' + oyf + '" x2="' + dxf + '" y2="' + dyf + '" stroke="darkblue" stroke-width="5"/>';

            //if ((navigator.userAgent.toLowerCase().indexOf('chrome') > -1) &&(navigator.vendor.toLowerCase().indexOf("google") > -1)) {
            if (touch.clientY >= (window.innerHeight - 40)) {
                document.body.scrollTop = (document.body.scrollTop + 5);
                document.documentElement.scrollTop = (document.documentElement.scrollTop + 5)
            }

            if (touch.clientY <= 40) {
                document.body.scrollTop = (document.body.scrollTop - 5);
                document.documentElement.scrollTop = (document.documentElement.scrollTop - 5)
            }
            //}

            event.preventDefault();
        }


        function farft(event) {
            document.getElementById('e' + 'l' + 's' + 'v' + 'g').innerHTML = "";
            document.getElementById('e' + 'l' + 's' + 'v' + 'g' + 'd' + 'e' + 'f' + 'i' + 'n' + 'i' + 't' + 'i' + 'v' + 'o').innerHTML = "";
            for (var z = 0; z < contenidoaguardar.length; z++) {
                texto = arreglarTexto(contenidoaguardar[z][0]);
                if (texto.indexOf("join:") == 0) {
                    if (arfi != z) {
                        eldivfinal = document.getElementById('j' + 'o' + 'i' + 'n' + 'd' + 'i' + 'v' + z);
                        if (eldivfinal.offsetTop < dyf && (eldivfinal.offsetTop + eldivfinal.offsetHeight) > dyf && eldivfinal.offsetLeft < dxf && (eldivfinal.offsetLeft + eldivfinal.offsetWidth) > dxf) {
                            htmldefinitivolinea = '<line x1="' + oxf + '" y1="' + oyf + '" x2="' + dxf + '" y2="' + dyf + '" stroke="darkblue" stroke-width="5"/>';
                            flechaunida[arfi] = String(z);
                            flechaunida[z] = String(arfi);
                            for (var k = 0; k < contenidoaguardar.length; k++) {
                                if (flechaunida[k].length > 0) {
                                    if (parseInt(flechaunida[k]) == z || parseInt(flechaunida[k]) == arfi) {
                                        contenidorellenado[k][5] = "";
                                    }
                                }
                            }
                            contenidorellenado[z][5] = htmldefinitivolinea.split('"').join('#');
                            contenidorellenado[arfi][5] = htmldefinitivolinea.split('"').join('#');
                            localStorage.setItem("contenidorellenado", JSON.stringify(contenidorellenado));
                        }
                    }
                }
            }

            for (var s = 0; s < contenidoaguardar.length; s++) {
                texto = arreglarTexto(contenidoaguardar[s][0]);
                if (texto.indexOf("join:") == 0) {
                    document.getElementById('e' + 'l' + 's' + 'v' + 'g' + 'd' + 'e' + 'f' + 'i' + 'n' + 'i' + 't' + 'i' + 'v' + 'o').innerHTML = document.getElementById("elsvgdefinitivo").innerHTML + contenidorellenado[s][5].split('#').join('"');
                }
            }
            oxf = 0;
            oyf = 0;

            document.removeEventListener('t' + 'o' + 'u' + 'c' + 'h' + 'm' + 'o' + 'v' + 'e', arft, {passive: false});
            document.removeEventListener('t' + 'o' + 'u' + 'c' + 'h' + 'e' + 'n' + 'd', farft, {passive: false});
        }


        function arf(e) {
            e.preventDefault();
            document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').style.cursor = "url('./images/pencil.png'),default";
            if (oxf == 0) {
                oxf = e.pageX - parseInt(document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetLeft);
            }
            if (oyf == 0) {
                oyf = e.pageY - parseInt(document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetTop);
            }
            dxf = e.pageX - parseInt(document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetLeft);
            dyf = e.pageY - parseInt(document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetTop);
            document.getElementById("capacanvas").innerHTML = '<svg id="elsvg" width="1000" height="1411"><line id="lineasvg" x1="' + oxf + '" y1="' + oyf + '" x2="' + dxf + '" y2="' + dyf + '" stroke="darkblue" stroke-width="5"/></svg>';

            //if ((navigator.userAgent.toLowerCase().indexOf('chrome') > -1) &&(navigator.vendor.toLowerCase().indexOf("google") > -1)) {
            if (e.clientY >= (window.innerHeight - 40)) {
                document.body.scrollTop = (document.body.scrollTop + 5);
                document.documentElement.scrollTop = (document.documentElement.scrollTop + 5)
            }

            if (e.clientY <= 40) {
                document.body.scrollTop = (document.body.scrollTop - 5);
                document.documentElement.scrollTop = (document.documentElement.scrollTop - 5)
            }
            //}
        }


        function farf(e) {
            document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').style.cursor = "default";
            document.getElementById("capacanvas").innerHTML = "";
            document.getElementById("capacanvas2").innerHTML = "";
            for (var z = 0; z < contenidoaguardar.length; z++) {
                texto = arreglarTexto(contenidoaguardar[z][0]);
                if (texto.indexOf("join:") == 0) {
                    if (arfi != z) {
                        eldivfinal = document.getElementById('j' + 'o' + 'i' + 'n' + 'd' + 'i' + 'v' + z);
                        if (eldivfinal.offsetTop < dyf && (eldivfinal.offsetTop + eldivfinal.offsetHeight) > dyf && eldivfinal.offsetLeft < dxf && (eldivfinal.offsetLeft + eldivfinal.offsetWidth) > dxf) {
                            htmldefinitivolinea = '<line x1="' + oxf + '" y1="' + oyf + '" x2="' + dxf + '" y2="' + dyf + '" stroke="darkblue" stroke-width="5"/>';
                            flechaunida[arfi] = String(z);
                            flechaunida[z] = String(arfi);
                            for (var k = 0; k < contenidoaguardar.length; k++) {
                                if (flechaunida[k].length > 0) {
                                    if (parseInt(flechaunida[k]) == z || parseInt(flechaunida[k]) == arfi) {
                                        contenidorellenado[k][5] = "";
                                    }
                                }
                            }
                            contenidorellenado[z][5] = htmldefinitivolinea.split('"').join('#');
                            contenidorellenado[arfi][5] = htmldefinitivolinea.split('"').join('#');
                            localStorage.setItem("contenidorellenado", JSON.stringify(contenidorellenado));
                        }
                    }
                }
            }
            var contenidohtmlcanvas2 = '<svg id="elsvgdefinitivo" width="1000" height="1411">';
            for (var s = 0; s < contenidoaguardar.length; s++) {
                texto = arreglarTexto(contenidoaguardar[s][0]);
                if (texto.indexOf("join:") == 0) {
                    contenidohtmlcanvas2 = contenidohtmlcanvas2 + contenidorellenado[s][5].split('#').join('"');
                }
            }
            document.getElementById("capacanvas2").innerHTML = contenidohtmlcanvas2 + '</svg>';
            oxf = 0;
            oyf = 0;
            document.removeEventListener('m' + 'o' + 'u' + 's' + 'e' + 'm' + 'o' + 'v' + 'e', arf, false);
            document.removeEventListener('m' + 'o' + 'u' + 's' + 'e' + 'u' + 'p', farf, false);
        }


        function drgtb(numero) {

            if (respuestascomprobadas == 0) {
                resizandoi = numero;
                document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.zIndex = "5000";
                anorg = contenidoaguardar[numero][4];
                alorg = contenidoaguardar[numero][3];
                leorg = contenidoaguardar[numero][2];
                toorg = contenidoaguardar[numero][1];
                annu = anorg;
                alnu = alorg;
                tonu = toorg;
                lenu = leorg;

                document.addEventListener('m' + 'o' + 'u' + 's' + 'e' + 'm' + 'o' + 'v' + 'e', artbx, false);
                document.addEventListener('m' + 'o' + 'u' + 's' + 'e' + 'u' + 'p', fartbx, false);

            }

        }


        function artbx(e) {
            e.preventDefault();
            lenu = e.pageX - parseInt(document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetLeft) - parseInt(anorg / 2);
            tonu = e.pageY - parseInt(document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetTop) - parseInt(alorg / 2);

            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.top = tonu + "px";
            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.left = lenu + "px";
            if (parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.height, 10) < 30 && parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.width, 10) < 30) {
                margendedrop = 12;
                margendedropnegativo = -12;
            } else if (parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.height, 10) < 50 && parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.width, 10) < 50) {
                margendedrop = 20;
                margendedropnegativo = -20;
            } else {
                margendedrop = 30;
                margendedropnegativo = -30;
            }

            var divs = document.getElementsByClassName('d' + 'r' + 'o' + 'p' + 'd' + 'i' + 'v');
            for (var i = 0; i < divs.length; i++) {
                if ((divs[i].offsetTop - tonu) < margendedrop && (divs[i].offsetTop - tonu) > margendedropnegativo && (divs[i].offsetLeft - lenu) < margendedrop && (divs[i].offsetLeft - lenu) > margendedropnegativo) {
                    droptop = divs[i].offsetTop;
                    dropleft = divs[i].offsetLeft;
                    document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.top = droptop + "px";
                    document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.left = dropleft + "px";
                }
            }
            if (e.clientY >= (window.innerHeight - 40)) {
                document.body.scrollTop = (document.body.scrollTop + 5);
                document.documentElement.scrollTop = (document.documentElement.scrollTop + 5)
            }

            if (e.clientY <= 40) {
                document.body.scrollTop = (document.body.scrollTop - 5);
                document.documentElement.scrollTop = (document.documentElement.scrollTop - 5)
            }
        }

        function fartbx() {
            document.removeEventListener('m' + 'o' + 'u' + 's' + 'e' + 'm' + 'o' + 'v' + 'e', artbx, false);
            document.removeEventListener('m' + 'o' + 'u' + 's' + 'e' + 'u' + 'p', fartbx, false);
            var divcolocado = 0;
            if (parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.height, 10) < 30 && parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.width, 10) < 30) {
                margendedrop = 12;
                margendedropnegativo = -12;
            } else if (parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.height, 10) < 50 && parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.width, 10) < 50) {
                margendedrop = 20;
                margendedropnegativo = -20;
            } else {
                margendedrop = 30;
                margendedropnegativo = -30;
            }
            var divs = document.getElementsByClassName('d' + 'r' + 'o' + 'p' + 'd' + 'i' + 'v');
            for (var i = 0; i < divs.length; i++) {
                if ((divs[i].offsetTop - tonu) < margendedrop && (divs[i].offsetTop - tonu) > margendedropnegativo && (divs[i].offsetLeft - lenu) < margendedrop && (divs[i].offsetLeft - lenu) > margendedropnegativo) {
                    droptop = divs[i].offsetTop;
                    dropleft = divs[i].offsetLeft;
                    document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.top = droptop + "px";
                    document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.left = dropleft + "px";
                    contenidorellenado[resizandoi][5] = droptop + "@" + dropleft;
                    localStorage.setItem("contenidorellenado", JSON.stringify(contenidorellenado));
                    divcolocado = 1;
                }
            }
            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.zIndex = "5";
            if (divcolocado == 0) {
                document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.top = toorg + "px";
                document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.left = leorg + "px";
            }

            resizandoi = 0;
        }


        function drgtbt(event) {

            event.preventDefault();

            if (event.target.id.indexOf("dragablediv") > -1) {

                elnumero = event.target.id.replace("dragablediv", "");

                if (elnumero.length > 0) {
                    if (isNaN(elnumero)) {

                    } else {
                        numero = parseInt(elnumero);
                        if (respuestascomprobadas == 0) {
                            resizandoi = numero;
                            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.zIndex = "5000";
                            anorg = contenidoaguardar[numero][4];
                            alorg = contenidoaguardar[numero][3];
                            leorg = contenidoaguardar[numero][2];
                            toorg = contenidoaguardar[numero][1];
                            annu = anorg;
                            alnu = alorg;
                            tonu = toorg;
                            lenu = leorg;

                            document.addEventListener('t' + 'o' + 'u' + 'c' + 'h' + 'm' + 'o' + 'v' + 'e', artbxt, {passive: false});
                            document.addEventListener('t' + 'o' + 'u' + 'c' + 'h' + 'e' + 'n' + 'd', fartbxt, {passive: false});

                        }
                    }
                }

            }

        }


        function artbxt(event) {
            event.preventDefault();
            var touch = event.targetTouches[0];
            toan = document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.top;
            lenu = touch.pageX - parseInt(document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetLeft) - parseInt(anorg / 2);
            tonu = touch.pageY - parseInt(document.getElementById('c' + 'a' + 'p' + 'a' + 'f' + 'o' + 'n' + 'd' + 'o').offsetTop) - parseInt(alorg / 2);

            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.top = tonu + "px";
            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.left = lenu + "px";
            if (parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.height, 10) < 30 && parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.width, 10) < 30) {
                margendedrop = 12;
                margendedropnegativo = -12;
            } else if (parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.height, 10) < 50 && parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.width, 10) < 50) {
                margendedrop = 20;
                margendedropnegativo = -20;
            } else {
                margendedrop = 30;
                margendedropnegativo = -30;
            }
            var divs = document.getElementsByClassName('d' + 'r' + 'o' + 'p' + 'd' + 'i' + 'v');
            for (var i = 0; i < divs.length; i++) {
                if ((divs[i].offsetTop - tonu) < margendedrop && (divs[i].offsetTop - tonu) > margendedropnegativo && (divs[i].offsetLeft - lenu) < margendedrop && (divs[i].offsetLeft - lenu) > margendedropnegativo) {
                    droptop = divs[i].offsetTop;
                    dropleft = divs[i].offsetLeft;
                    document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.top = droptop + "px";
                    document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.left = dropleft + "px";
                }
            }

            if (touch.screenY < 100 || touch.clientY < 100) {
                window.scrollBy(0, -5);
            }

            if (navigator.userAgent.toLowerCase().indexOf("android") > -1) {
                if ((screen.height - touch.screenY) < 100) {
                    window.scrollBy(0, 5);
                }
            } else {
                if ((window.innerHeight - touch.clientY) < 100) {
                    window.scrollBy(0, 5);
                }
            }
        }


        function fartbxt() {
            document.removeEventListener('t' + 'o' + 'u' + 'c' + 'h' + 'm' + 'o' + 'v' + 'e', artbxt, {passive: false});
            document.removeEventListener('t' + 'o' + 'u' + 'c' + 'h' + 'e' + 'n' + 'd', fartbxt, {passive: false});
            var divcolocado = 0;
            if (parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.height, 10) < 30 && parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.width, 10) < 30) {
                margendedrop = 12;
                margendedropnegativo = -12;
            } else if (parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.height, 10) < 50 && parseInt(document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.width, 10) < 50) {
                margendedrop = 20;
                margendedropnegativo = -20;
            } else {
                margendedrop = 30;
                margendedropnegativo = -30;
            }
            var divs = document.getElementsByClassName('d' + 'r' + 'o' + 'p' + 'd' + 'i' + 'v');
            for (var i = 0; i < divs.length; i++) {
                if ((divs[i].offsetTop - tonu) < margendedrop && (divs[i].offsetTop - tonu) > margendedropnegativo && (divs[i].offsetLeft - lenu) < margendedrop && (divs[i].offsetLeft - lenu) > margendedropnegativo) {
                    droptop = divs[i].offsetTop;
                    dropleft = divs[i].offsetLeft;
                    document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.top = droptop + "px";
                    document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.left = dropleft + "px";
                    contenidorellenado[resizandoi][5] = droptop + "@" + dropleft;
                    localStorage.setItem("contenidorellenado", JSON.stringify(contenidorellenado));
                    divcolocado = 1;
                }
            }
            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.zIndex = "5";
            if (divcolocado == 0) {
                document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.top = toorg + "px";
                document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + resizandoi).style.left = leorg + "px";
            }

            resizandoi = 0;
        }


        function saveselectbox(numero) {
            var e = document.getElementById('s' + 'e' + 'l' + 'e' + 'c' + 't' + 'b' + 'o' + 'x' + numero);
            var strUser = e.selectedIndex;
            contenidorellenado[numero][5] = strUser;
            localStorage.setItem("contenidorellenado", JSON.stringify(contenidorellenado));
        }

        function savespeakbox(numero) {
            var e = document.getElementById('s' + 'p' + 'e' + 'a' + 'k' + 'b' + 'o' + 'x' + numero).innerText;
            contenidorellenado[numero][5] = arreglarTextoparaguardar(e);
            localStorage.setItem("contenidorellenado", JSON.stringify(contenidorellenado));
        }

        function savetextbox(numero) {
            var e = document.getElementById("textbox" + numero).innerText;
            contenidorellenado[numero][5] = arreglarTextoparaguardar(e);
            localStorage.setItem("contenidorellenado", JSON.stringify(contenidorellenado));
        }


        function selectanswer(numero) {
            if (respuestascomprobadas == 0) {
                if (clickedanswer[numero] == "yes") {
                    //document.getElementById('s'+'e'+'l'+'e'+'c'+'t'+'a'+'b'+'l'+'e'+'d'+'i'+'v' + numero).style.background = "rgba(130, 200, 230, 0.2)";
                    document.getElementById('selectablediv' + numero).className = "selectablediv";
                    clickedanswer[numero] = "no";
                    contenidorellenado[numero][5] = "no";
                } else {
                    //document.getElementById('s'+'e'+'l'+'e'+'c'+'t'+'a'+'b'+'l'+'e'+'d'+'i'+'v' + numero).style.background = "rgba(30, 160, 2230, 0.5)";
                    document.getElementById('selectablediv' + numero).className = "selectedselectablediv";
                    clickedanswer[numero] = "yes";
                    contenidorellenado[numero][5] = "yes";
                }
            }
        }


        function tickanswer(numero) {
            if (respuestascomprobadas == 0) {
                if (clickedanswer[numero] == "yes") {
                    document.getElementById('tickbox' + numero).innerHTML = "";
                    clickedanswer[numero] = "no";
                    contenidorellenado[numero][5] = "no";
                } else {
                    document.getElementById('tickbox' + numero).innerHTML = "✓";
                    clickedanswer[numero] = "yes";
                    contenidorellenado[numero][5] = "yes";
                }
            }
        }


        function heTerminado() {
            //finish дарсан
            document.getElementById("capafinish").style.display = "none";
            comprobarRespuestas(1);
        }

        function comprobarRespuestas(mostrando) {
            pnt = 0;
            aciertos = 0;
            preguntas = 0;
            var aciertostotales = 0;
            var preguntastotales = 0;
            var numerodeselectyes = 0;
            var numerodeselectclicked = 0;
            var excesodeseleccionados = 0;
            var totalvalue = 0;
            var procedemosabuscar = 0;
            var arrayprocesados = [];
            var mintop = 0;
            var maxtop = 0;
            var minleft = 0;
            var maxleft = 0;
            var thevalue = 0;

            var estamosmostrando;

            estamosmostrando = mostrando;

            console.log("contenidoaguardar")
            console.log(contenidoaguardar)

            for (var q = 0; q < (contenidoaguardar.length + 1); q++) {
                procedemosabuscar = 0;
                if (q < contenidoaguardar.length) {
                    //todo check Үр дүнг гаргах хэсэг
                    thetext = arreglarTexto(contenidoaguardar[q][0]);

                    if (thetext.toLowerCase().indexOf("value:") == 0) {

                        elvalor = thetext.toLowerCase().replace("value:", "");
                        elvalor = elvalor.split(" ").join("");
                        elvalor = elvalor.split(",").join(".");

                        if (isNaN(elvalor)) {
                            //Тоо биш үед гарах алдаа
                        } else {
                            //content ийн координатын хэсэг
                            thevalue = Number(elvalor);
                            totalvalue = totalvalue + thevalue;

                            mintop = Number(contenidoaguardar[q][1]);
                            maxtop = Number(contenidoaguardar[q][1]) + Number(contenidoaguardar[q][3]);
                            minleft = Number(contenidoaguardar[q][2]);
                            maxleft = Number(contenidoaguardar[q][2]) + Number(contenidoaguardar[q][4]);

                            procedemosabuscar = 1;
                        }

                    }

                } else { //Дөрвөн дотор ямар нэгэн утга байгаа эсэхийг шалгах
                    if (totalvalue > 10) {
                        thevalue = 0;
                    } else {
                        thevalue = 10 - totalvalue;
                        totalvalue = 10;
                    }
                    mintop = 0;
                    maxtop = 1000000000;
                    minleft = 0;
                    maxleft = 1000000000;
                    procedemosabuscar = 1;
                }

                if (procedemosabuscar = 1) {
                    aciertos = 0;
                    preguntas = 0;
                    numerodeselectyes = 0;
                    numerodeselectclicked = 0;
                    for (var j = 0; j < contenidoaguardar.length; j++) {
                        boxmintop = Number(contenidoaguardar[j][1]);
                        boxmaxtop = Number(contenidoaguardar[j][1]) + Number(contenidoaguardar[j][3]);
                        boxminleft = Number(contenidoaguardar[j][2]);
                        boxmaxleft = Number(contenidoaguardar[j][2]) + Number(contenidoaguardar[j][4]);
                        if (boxmintop > mintop && boxmaxtop < maxtop && boxminleft > minleft && boxmaxleft < maxleft) {

                            if (arrayprocesados.includes(j)) {

                            } else {

                                arrayprocesados.push(j);

                                existetambieneldrop = 0;
                                texto = arreglarTexto(contenidoaguardar[j][0]);
                                if (texto.toLowerCase().indexOf("wordsearch(") == 0) {
                                    var preguntasws = 0;
                                    var aciertosws = 0;
                                    var separardospuntos = texto.split(":");
                                    var casillaswordsearch = separardospuntos[1];
                                    for (var p = 0; p < casillaswordsearch.length; p++) {
                                        if (casillaswordsearch.charAt(p) == "v") {
                                            preguntasws = preguntasws + 1;
                                            if (contenidorellenado[j][5].charAt(p) == "v") {
                                                aciertosws = aciertosws + 1;
                                                if (estamosmostrando == 1) {
                                                    document.getElementById("td" + j + "-" + p).setAttribute("class", "rightwordsearchtd");
                                                }
                                            }
                                        } else {
                                            if (contenidorellenado[j][5].charAt(p) == "v") {
                                                aciertosws = aciertosws - 0.2;
                                                if (estamosmostrando == 1) {
                                                    document.getElementById("td" + j + "-" + p).setAttribute("class", "wrongwordsearchtd");
                                                }
                                            }
                                        }
                                    }
                                    if (aciertosws < 0) {
                                        aciertosws = 0;
                                    }
                                    preguntas = preguntas + (preguntasws / 5);
                                    aciertos = aciertos + (aciertosws / 5);
                                } else if (texto.toLowerCase().indexOf("choose:") == 0) {
                                    if (texto.indexOf("*") > 0) {
                                        preguntas++;
                                        if (document.getElementById('s' + 'e' + 'l' + 'e' + 'c' + 't' + 'b' + 'o' + 'x' + j).value == "right") {
                                            if (estamosmostrando == 1) {
                                                document.getElementById('s' + 'e' + 'l' + 'e' + 'c' + 't' + 'b' + 'o' + 'x' + j).style.backgroundColor = '#66FF99';
                                                document.getElementById('s' + 'e' + 'l' + 'e' + 'c' + 't' + 'b' + 'o' + 'x' + j).style.opacity = "0.5";
                                                document.getElementById('s' + 'e' + 'l' + 'e' + 'c' + 't' + 'b' + 'o' + 'x' + j).style.color = "#0000FF";
                                            }
                                            aciertos++;
                                        } else {
                                            if (estamosmostrando == 1) {
                                                document.getElementById('s' + 'e' + 'l' + 'e' + 'c' + 't' + 'b' + 'o' + 'x' + j).style.backgroundColor = '#FF6666';
                                                document.getElementById('s' + 'e' + 'l' + 'e' + 'c' + 't' + 'b' + 'o' + 'x' + j).style.opacity = "0.5";
                                                document.getElementById('s' + 'e' + 'l' + 'e' + 'c' + 't' + 'b' + 'o' + 'x' + j).style.color = "#0000FF";
                                            }
                                            errores++;
                                        }

                                        if (estamosmostrando == 1) {
                                            var op = document.getElementById('s' + 'e' + 'l' + 'e' + 'c' + 't' + 'b' + 'o' + 'x' + j).getElementsByTagName("option");
                                            for (var i = 0; i < op.length; i++) {
                                                op[i].disabled = true;

                                                if (i > 0) {
                                                    if (op[i].value.toLowerCase() != "right") {
                                                        op[i].style.backgroundColor = '#FF6666';
                                                    } else {
                                                        op[i].style.backgroundColor = '#66FF99';
                                                    }
                                                }

                                            }
                                        }
                                    }
                                } else if (texto.toLowerCase().indexOf('s' + 'e' + 'l' + 'e' + 'c' + 't' + ":" + 'y' + 'e' + 's') == 0) {
                                    preguntas++;
                                    numerodeselectyes++;
                                    if (clickedanswer[j] == 'y' + 'e' + 's') {
                                        if (estamosmostrando == 1) {
                                            document.getElementById("selectablediv" + j).className = "rightselectablediv";
                                        }
                                        aciertos++;
                                        numerodeselectclicked++;
                                    }

                                } else if (texto.toLowerCase().indexOf('s' + 'e' + 'l' + 'e' + 'c' + 't' + ":" + 'n' + 'o') == 0) {
                                    if (clickedanswer[j] == 'y' + 'e' + 's') {
                                        if (estamosmostrando == 1) {
                                            document.getElementById("selectablediv" + j).className = "wrongselectablediv";
                                        }
                                        numerodeselectclicked++;
                                    }

                                } else if (texto.toLowerCase().indexOf('s' + 'e' + 'l' + 'e' + 'c' + 't' + ":") == 0) {
                                    if (clickedanswer[j] == 'y' + 'e' + 's') {
                                        if (estamosmostrando == 1) {
                                            document.getElementById("selectablediv" + j).className = "rightselectablediv";
                                        }
                                    }

                                } else if (texto.toLowerCase().indexOf('tick:yes') == 0) {
                                    preguntas++;
                                    numerodeselectyes++;
                                    if (clickedanswer[j] == 'yes') {
                                        if (estamosmostrando == 1) {
                                            document.getElementById("tickbox" + j).className = "righttickbox";
                                        }
                                        aciertos++;
                                        numerodeselectclicked++;
                                    }

                                } else if (texto.toLowerCase().indexOf('tick:no') == 0) {
                                    if (clickedanswer[j] == 'yes') {
                                        if (estamosmostrando == 1) {
                                            document.getElementById("tickbox" + j).className = "wrongtickbox";
                                        }
                                        numerodeselectclicked++;
                                    }

                                } else if (texto.toLowerCase().indexOf('s' + 'p' + 'e' + 'a' + 'k' + "(") == 0 && texto.toLowerCase().indexOf("):") > 0) {
                                    if (texto.split(":")[1].length > 0) {
                                        preguntas++;
                                    }
                                    textorespuesta = "/" + arreglarTexto(document.getElementById('s' + 'p' + 'e' + 'a' + 'k' + 'b' + 'o' + 'x' + j).innerText) + "/";
                                    textorespuesta = textorespuesta.toLowerCase();
                                    textorespuesta = textorespuesta.split(".").join("");
                                    textorespuesta = textorespuesta.split(",").join("");
                                    textorespuesta = textorespuesta.split(";").join("");
                                    textorespuesta = textorespuesta.split(":").join("");
                                    textorespuesta = textorespuesta.split("?").join("");
                                    textorespuesta = textorespuesta.split("¿").join("");
                                    textorespuesta = textorespuesta.split("!").join("");
                                    textorespuesta = textorespuesta.split("¡").join("");
                                    eltextocorrecto = texto.substring(texto.indexOf("):") + 2);
                                    textocorrecto = "/" + arreglarTexto(eltextocorrecto) + "/";
                                    textocorrecto = textocorrecto.toLowerCase();
                                    textocorrecto = textocorrecto.split(".").join("");
                                    textocorrecto = textocorrecto.split(",").join("");
                                    textocorrecto = textocorrecto.split(";").join("");
                                    textocorrecto = textocorrecto.split(":").join("");
                                    textocorrecto = textocorrecto.split("?").join("");
                                    textocorrecto = textocorrecto.split("¿").join("");
                                    textocorrecto = textocorrecto.split("!").join("");
                                    textocorrecto = textocorrecto.split("¡").join("");
                                    mostrarrespuestacorrecta = eltextocorrecto.split("$").join("'");
                                    mostrarrespuestacorrecta = mostrarrespuestacorrecta.split("#").join('"');
                                    if (textocorrecto.indexOf(textorespuesta) == -1 && texto.split(":")[1].length > 0) {
                                        if (estamosmostrando == 1) {
                                            document.getElementById('s' + 'p' + 'e' + 'a' + 'k' + 'b' + 'o' + 'x' + j).style.backgroundColor = '#FF6666';
                                            document.getElementById('s' + 'p' + 'e' + 'a' + 'k' + 'b' + 'o' + 'x' + j).style.opacity = "0.5";
                                            document.getElementById('s' + 'p' + 'e' + 'a' + 'k' + 'b' + 'o' + 'x' + j).style.color = "#0000FF";

                                            document.getElementById('s' + 'p' + 'e' + 'a' + 'k' + 'b' + 'o' + 'x' + j).setAttribute("title", "Right answer: " + mostrarrespuestacorrecta);

                                        }
                                    }
                                    if (textocorrecto.indexOf(textorespuesta) > -1 && texto.split(":")[1].length > 0) {
                                        if (estamosmostrando == 1) {
                                            document.getElementById('s' + 'p' + 'e' + 'a' + 'k' + 'b' + 'o' + 'x' + j).style.backgroundColor = '#66FF99';
                                            document.getElementById('s' + 'p' + 'e' + 'a' + 'k' + 'b' + 'o' + 'x' + j).style.opacity = "0.5";
                                            document.getElementById('s' + 'p' + 'e' + 'a' + 'k' + 'b' + 'o' + 'x' + j).style.color = "#0000FF";
                                        }
                                        aciertos++;
                                    }
                                } else if (texto.toLowerCase().indexOf('l' + 'i' + 's' + 't' + 'e' + 'n' + "(") == 0) {
                                } else if (validateYouTubeUrl(contenidoaguardar[j][0]).length > 1) {
                                } else if (texto.toLowerCase().indexOf("playmp3:") == 0) {
                                } else if (texto.toLowerCase().indexOf("link:") == 0) {
                                } else if (texto.toLowerCase().indexOf("print:") == 0) {
                                } else if (texto.toLowerCase().indexOf("value:") == 0) {
                                } else if (texto.toLowerCase().indexOf('d' + 'r' + 'a' + 'g' + ":") == 0) {
                                    if (texto.length > 5) {
                                        preguntas++;
                                        if (estamosmostrando == 1) {
                                            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j).style.borderStyle = 'solid';
                                            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j).style.borderColor = '#FF6666';
                                            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j).style.borderWidth = '3px';
                                        }
                                        textodeldrag = texto.split(" ").join("");
                                        textodeldrag = textodeldrag.toLowerCase();
                                        numerodeldrag = textodeldrag.split('d' + 'r' + 'a' + 'g' + ":").join("");
                                        for (var h = 0; h < contenidoaguardar.length; h++) {
                                            textodeldrop = arreglarTexto(contenidoaguardar[h][0]);
                                            textodeldrop = textodeldrop.split(" ").join("");
                                            textodeldrop = textodeldrop.toLowerCase();
                                            if (textodeldrop.indexOf('d' + 'r' + 'o' + 'p' + ":") == 0) {
                                                numerodeldrop = textodeldrop.split('d' + 'r' + 'o' + 'p' + ":").join("");
                                                if (numerodeldrop == numerodeldrag) {
                                                    if (document.getElementById('d' + 'r' + 'o' + 'p' + 'd' + 'i' + 'v' + h).offsetTop > document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j).offsetTop - 2 && document.getElementById('d' + 'r' + 'o' + 'p' + 'd' + 'i' + 'v' + h).offsetTop < document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j).offsetTop + 2 && document.getElementById("dropdiv" + h).offsetLeft > document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j).offsetLeft - 2 && document.getElementById("dropdiv" + h).offsetLeft < document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j).offsetLeft + 2) {
                                                        if (estamosmostrando == 1) {
                                                            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j).style.borderStyle = 'solid';
                                                            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j).style.borderColor = '#66FF99';
                                                            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j).style.borderWidth = '3px';
                                                        }
                                                        aciertos++;
                                                    }
                                                }
                                            }
                                        }
                                    } else if (contenidorellenado[j][5].length > 0) {
                                        if (estamosmostrando == 1) {
                                            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j).style.borderStyle = 'solid';
                                            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j).style.borderColor = '#FF6666';
                                            document.getElementById('d' + 'r' + 'a' + 'g' + 'a' + 'b' + 'l' + 'e' + 'd' + 'i' + 'v' + j).style.borderWidth = '3px';
                                        }
                                    }
                                } else if (texto.toLowerCase().indexOf('j' + 'o' + 'i' + 'n' + ":") == 0) {
                                    preguntas = preguntas + 0.5;
                                    if (contenidorellenado[j][5].length > 0) {
                                        for (var r = 0; r < contenidorellenado.length; r++) {
                                            if (contenidorellenado[j][5] == contenidorellenado[r][5] && r != j) {
                                                if (texto == arreglarTexto(contenidoaguardar[r][0])) {
                                                    if (estamosmostrando == 1) {
                                                        document.getElementById('j' + 'o' + 'i' + 'n' + 'd' + 'i' + 'v' + j).style.borderStyle = 'solid';
                                                        document.getElementById('j' + 'o' + 'i' + 'n' + 'd' + 'i' + 'v' + j).style.borderColor = '#66FF99';
                                                        document.getElementById('j' + 'o' + 'i' + 'n' + 'd' + 'i' + 'v' + j).style.borderWidth = '3px';
                                                    }
                                                    aciertos = aciertos + 0.5;
                                                } else {
                                                    if (estamosmostrando == 1) {
                                                        document.getElementById('j' + 'o' + 'i' + 'n' + 'd' + 'i' + 'v' + j).style.borderStyle = 'solid';
                                                        document.getElementById('j' + 'o' + 'i' + 'n' + 'd' + 'i' + 'v' + j).style.borderColor = '#FF6666';
                                                        document.getElementById('j' + 'o' + 'i' + 'n' + 'd' + 'i' + 'v' + j).style.borderWidth = '3px';
                                                    }
                                                }
                                            }
                                        }
                                    } else {
                                        if (estamosmostrando == 1) {
                                            document.getElementById('j' + 'o' + 'i' + 'n' + 'd' + 'i' + 'v' + j).style.borderStyle = 'solid';
                                            document.getElementById('j' + 'o' + 'i' + 'n' + 'd' + 'i' + 'v' + j).style.borderColor = '#FF6666';
                                            document.getElementById('j' + 'o' + 'i' + 'n' + 'd' + 'i' + 'v' + j).style.borderWidth = '3px';
                                        }
                                    }
                                } else if (texto.toLowerCase().indexOf('d' + 'r' + 'o' + 'p' + ":") == 0) {
                                } else if (texto.toLowerCase().indexOf('tick:') == 0) {
                                } else if (texto.toLowerCase().indexOf('select:') == 0) {
                                } else {
                                    if (contenidoaguardar[j][0].length > 0) {
                                        preguntas++;
                                        textorespuesta = document.getElementById('t' + 'e' + 'x' + 't' + 'b' + 'o' + 'x' + j).innerText;
                                        if (ignorarmayusculas == 1) {
                                            textorespuesta = textorespuesta.toLowerCase();
                                        }
                                        if (ignorarsignos == 1) {
                                            textorespuesta = eliminarsignos(textorespuesta);
                                        }
                                        if (ignoraracentos == 1) {
                                            textorespuesta = eliminaracentos(textorespuesta);
                                        }
                                        textorespuesta = "/" + arreglarTexto(textorespuesta) + "/";

                                        textocorrecto = contenidoaguardar[j][0];
                                        if (ignorarmayusculas == 1) {
                                            textocorrecto = textocorrecto.toLowerCase();
                                        }
                                        if (ignorarsignos == 1) {
                                            textocorrecto = eliminarsignos(textocorrecto);
                                        }
                                        if (ignoraracentos == 1) {
                                            textocorrecto = eliminaracentos(textocorrecto);
                                        }
                                        textocorrecto = "/" + arreglarTexto(textocorrecto) + "/";

                                        mostrarrespuestacorrecta = contenidoaguardar[j][0].split("$").join("'");
                                        mostrarrespuestacorrecta = mostrarrespuestacorrecta.split("#").join('"');
                                        if (textocorrecto.indexOf(textorespuesta) == -1) {
                                            if (estamosmostrando == 1) {
                                                document.getElementById('t' + 'e' + 'x' + 't' + 'b' + 'o' + 'x' + j).style.backgroundColor = '#FF6666';
                                                document.getElementById('t' + 'e' + 'x' + 't' + 'b' + 'o' + 'x' + j).style.opacity = "0.5";
                                                document.getElementById('t' + 'e' + 'x' + 't' + 'b' + 'o' + 'x' + j).style.color = "#0000FF";
                                                document.getElementById('t' + 'e' + 'x' + 't' + 'b' + 'o' + 'x' + j).setAttribute("contenteditable", false);
                                                document.getElementById('t' + 'e' + 'x' + 't' + 'b' + 'o' + 'x' + j).setAttribute("title", "Right answer: " + mostrarrespuestacorrecta);
                                            }
                                        }
                                        if (textocorrecto.indexOf(textorespuesta) > -1) {
                                            if (estamosmostrando == 1) {
                                                document.getElementById('t' + 'e' + 'x' + 't' + 'b' + 'o' + 'x' + j).style.backgroundColor = '#66FF99';
                                                document.getElementById('t' + 'e' + 'x' + 't' + 'b' + 'o' + 'x' + j).style.opacity = "0.5";
                                                document.getElementById('t' + 'e' + 'x' + 't' + 'b' + 'o' + 'x' + j).style.color = "#0000FF";
                                                document.getElementById('t' + 'e' + 'x' + 't' + 'b' + 'o' + 'x' + j).setAttribute("contenteditable", false);
                                            }
                                            aciertos++;
                                        }
                                    }
                                }
                            } //if (arrayprocesados.includes(j)) {
                        } //if (boxmintop > mintop && boxmaxtop < maxtop && boxminleft > minleft && boxmaxleft < maxleft) {
                    } //for (var j=0; j < contenidoaguardar.length; j++){

                    excesodeseleccionados = numerodeselectclicked - numerodeselectyes;
                    if (excesodeseleccionados > numerodeselectyes) {
                        excesodeseleccionados = numerodeselectyes;
                    }
                    if (excesodeseleccionados > 0) {
                        aciertos = aciertos - excesodeseleccionados;
                    }
                    if (preguntas > 0) {
                        lapnt = (aciertos * thevalue) / preguntas;
                        lapnt = Math.round(lapnt * 10) / 10;
                        if (lapnt < 0) {
                            lapnt = 0;
                        }
                        if (lapnt > thevalue) {
                            lapnt = thevalue;
                        }
                        aciertostotales = aciertostotales + lapnt;
                        preguntastotales = preguntastotales + thevalue;
                    }


                } //if (procedemosabuscar = 1)


            } // for (var q=0; q < (contenidoaguardar.length + 1); q++)

            if (preguntastotales > 0) {
                pnt = (aciertostotales * 10) / totalvalue;
                pnt = Math.round(pnt * 10) / 10;
                if (pnt < 0) {
                    pnt = 0;
                }
                if (pnt > 10) {
                    pnt = 10
                }
            } else {
                pnt = 11;
            }


            if (mostrando == 1) {
                mostrarpnt();
                respuestascomprobadas = 1;
            }

        }


        function mostrarpnt() {
            // point харуулах хэсэг
            if (pnt < 11) {
                document.getElementById("capanotas").innerHTML = '<img src="https://www.liveworksheets.com/lwsmaker/images/marks' + Math.round(pnt) + '.png">';
                document.getElementById("capanotas").style.display = "block";
            }
        }
        function localstorageTest() {
            var test = 'test';
            try {
                localStorage.setItem(test, test);
                localStorage.removeItem(test);
                return true;
            } catch (e) {
                return false;
            }
        }


        function supportsSVG() {
            return !!document.createElementNS && !!document.createElementNS('http://www.w3.org/2000/svg', "svg").createSVGRect;
        }


        function comprobarRequisitos() {
            // шалгах хэсэг
            if (navigator.cookieEnabled) {
                cookieshabilidadas = 1;
            } else {
                alert("The WorkSheet does not work without cookies. Please enable cookies in your web browser");
            }
            if (localstorageTest() === false) {
                alert("The WorkSheet does not work without Local Storage. Please enable Local Storage in your web browser");
            }
            if (supportsSVG() === false) {
                alert("It seems that your web browser does not support SVG graphics. Please update to the latest version or try Google Chrome.");
            }

        }

        function replece(str) {
            var str2 = str.replace("v", "c");
            str2 = str2.replace("e", "l");
            str2 = str2.replace("w", "a");
            return str2;
        }


    </script>
    <style>
        .capanotas {
            font-size: 120px;
            font-family: 'Permanent Marker', cursive;
            color: #FF0000;
            padding-left: 50px;
            text-shadow: -2px -2px 0 #ffffff,
            2px -2px 0 #FFFFFF,
            -2px 2px 0 #FFFFFF,
            2px 2px 0 #FFFFFF;
        }
        .textbox {
            background-color: rgba(255, 255, 255, 0.5);
            border: 0px solid #c4c4c4;
            font-family: Comic Sans MS;
            color: #3399FF;
            padding: 4px 4px 4px 4px;
            border-radius: 4px;
            -moz-border-radius: 4px;
            -webkit-border-radius: 4px;
            box-shadow: 0px 0px 8px #999999;
            -moz-box-shadow: 0px 0px 8px #999999;
            -webkit-box-shadow: 0px 0px 8px #999999;
        }

        .dragablediv {
            border-radius: 4px;
            -moz-border-radius: 4px;
            -webkit-border-radius: 4px;
            box-shadow: 0px 0px 8px #999999;
            -moz-box-shadow: 0px 0px 8px #999999;
            -webkit-box-shadow: 0px 0px 8px #999999;
        }

        .blankdiv {
            border-radius: 4px;
        }

        .joindiv {
            border-radius: 4px;
            cursor:url('./images/pencil.png'), pointer;
        }

        .selectbox {
            z-index: 4;
            background-color: rgba(255, 255, 255, 0.5);
            border: 0px solid #c4c4c4;
            font-family: Arial;
            color: #0000CC;
            border-radius: 4px;
            -moz-border-radius: 4px;
            -webkit-border-radius: 4px;
            box-shadow: 0px 0px 8px #999999;
            -moz-box-shadow: 0px 0px 8px #999999;
            -webkit-box-shadow: 0px 0px 8px #999999;
        }


        .tickbox {
            z-index: 4;
            text-align: center;
            vertical-align: middle;
            background-color: #028ef2;
            border: 1px solid #0171c1;
            font-family: Arial;
            color: #FFFFFF;
            border-radius: 4px;
            -moz-border-radius: 4px;
            -webkit-border-radius: 4px;
            box-shadow: 0px 0px 8px #999999;
            -moz-box-shadow: 0px 0px 8px #999999;
            -webkit-box-shadow: 0px 0px 8px #999999;
        }

        .righttickbox {
            z-index: 4;
            text-align: center;
            vertical-align: middle;
            background-color: #1cbc2c;
            border: 1px solid #107f1b;
            font-family: Arial;
            color: #FFFFFF;
            border-radius: 4px;
            -moz-border-radius: 4px;
            -webkit-border-radius: 4px;
            box-shadow: 0px 0px 8px #999999;
            -moz-box-shadow: 0px 0px 8px #999999;
            -webkit-box-shadow: 0px 0px 8px #999999;
        }

        .wrongtickbox {
            z-index: 4;
            text-align: center;
            vertical-align: middle;
            background-color: #f93636;
            border: 1px solid #b22525;
            font-family: Arial;
            color: #FFFFFF;
            border-radius: 4px;
            -moz-border-radius: 4px;
            -webkit-border-radius: 4px;
            box-shadow: 0px 0px 8px #999999;
            -moz-box-shadow: 0px 0px 8px #999999;
            -webkit-box-shadow: 0px 0px 8px #999999;
        }


        .editablediv {
            text-align: center;
            z-index: 4;
            background-color: rgba(255, 255, 255, 0.5);
            overflow: hidden;
            font-size: 14px;
            font-family: Arial;
            color: #0000CC;
            border: 1px solid #c4c4c4;
            border-radius: 4px;
            -moz-border-radius: 4px;
            -webkit-border-radius: 4px;
            box-shadow: 0px 0px 8px #d9d9d9;
            -moz-box-shadow: 0px 0px 8px #d9d9d9;
            -webkit-box-shadow: 0px 0px 8px #d9d9d9;

        }

        .printboxdiv {
            text-align: left;
            z-index: 4;
            background-color: rgba(255, 255, 255, 1);
            overflow: hidden;
            font-size: 14px;
            font-family: Arial;
            color: #0000CC;
            border: 0px;
            border-radius: 4px;
            -moz-border-radius: 4px;
            -webkit-border-radius: 4px;

        }

        .capafondo {
            position: relative;
            margin-left: auto;
            margin-right: auto;
            margin-top: 0;
            top: 10px;
            border: 0px solid #999999;
            background: #FFFFFF;
            box-shadow: 0px 0px 10px #666666;
        }


        .capamenu {
            margin-left: auto;
            margin-right: auto;
            margin-top: 5px;
        }

        .link {
            cursor: pointer;

        }

        .link:hover {
            color: #3399FF;

        }

        .botonfinish {
            z-index: 5;
            cursor: pointer;
            border: 2px solid #c4c4c4;
            font-family: Arial;
            font-size: 36px;
            color: #3399FF;
            padding: 4px 4px 4px 4px;
            border-radius: 4px;
            -moz-border-radius: 4px;
            -webkit-border-radius: 4px;
            box-shadow: 0px 0px 8px #999999;
            -moz-box-shadow: 0px 0px 8px #999999;
            -webkit-box-shadow: 0px 0px 8px #999999;
        }


        .finishbutton {

            background-color: #55acee;
            box-shadow: 0px 5px 0px 0px #3C93D5;
            cursor: pointer;
            font-size: 25px;
            font-family: Arial;
            color: #FFFFFF;
            border-radius: 5px;
            z-index: 3;
            position: absolute;
            margin-right: auto;
            margin-left: auto;
            left: 0;
            right: 0;
            width: 300px;
            height: 60px;
            line-height: 60px;
            text-align: center;
            vertical-align: middle;

        }


        .finishbutton:hover {
            background-color: #6FC6FF;

        }

        .selectablediv {
            border-radius: 4px;
            background: -moz-linear-gradient(top, rgba(149, 230, 244, 0.1) 0%, rgba(14, 185, 237, 0.3) 100%);
            background: -webkit-linear-gradient(top, rgba(149, 230, 244, 0.1) 0%, rgba(14, 185, 237, 0.3) 100%);
            background: linear-gradient(to bottom, rgba(149, 230, 244, 0.1) 0%, rgba(14, 185, 237, 0.3) 100%);
            box-shadow: 0px 0px 3px 0px rgba(0, 0, 0, 0.5);
        }

        .selectablediv:hover {
            border-radius: 4px;
            background: -moz-linear-gradient(top, rgba(149, 230, 244, 0.3) 0%, rgba(14, 185, 237, 0.5) 100%);
            background: -webkit-linear-gradient(top, rgba(149, 230, 244, 0.3) 0%, rgba(14, 185, 237, 0.5) 100%);
            background: linear-gradient(to bottom, rgba(149, 230, 244, 0.3) 0%, rgba(14, 185, 237, 0.5) 100%);
            box-shadow: 0px 0px 3px 0px rgba(0, 0, 0, 0.5);
        }

        .selectedselectablediv {
            border-radius: 4px;
            background: -moz-linear-gradient(top, rgba(195, 255, 0, 0.5) 0%, rgba(166, 216, 0, 0.5) 100%);
            background: -webkit-linear-gradient(top, rgba(195, 255, 0, 0.5) 0%, rgba(166, 216, 0, 0.5) 100%);
            background: linear-gradient(to bottom, rgba(195, 255, 0, 0.5) 0%, rgba(166, 216, 0, 0.5) 100%);
            box-shadow: 0px 0px 5px 0px rgba(14, 185, 237, 0.7);
        }

        .selectedselectabledivcopia {
            border-radius: 4px;
            background: -moz-linear-gradient(top, rgba(175, 188, 247, 0.5) 0%, rgba(158, 130, 242, 0.5) 100%);
            background: -webkit-linear-gradient(top, rgba(175, 188, 247, 0.5) 0%, rgba(158, 130, 242, 0.5) 100%);
            background: linear-gradient(to bottom, rgba(175, 188, 247, 0.5) 0%, rgba(158, 130, 242, 0.5) 100%);
            box-shadow: 0px 0px 5px 0px rgba(249, 246, 19, 0.9);
        }

        .rightselectablediv {
            border-radius: 4px;
            background: -moz-linear-gradient(top, rgba(133, 242, 116, 0.3) 0%, rgba(23, 153, 9, 0.5) 100%);
            background: -webkit-linear-gradient(top, rgba(133, 242, 116, 0.3) 0%, rgba(23, 153, 9, 0.5) 100%);
            background: linear-gradient(to bottom, rgba(133, 242, 116, 0.3) 0%, rgba(23, 153, 9, 0.5) 100%);
            box-shadow: 0px 0px 3px 0px rgba(0, 0, 0, 0.5);
        }

        .wrongselectablediv {
            border-radius: 4px;
            background: -moz-linear-gradient(top, rgba(226, 112, 104, 0.3) 0%, rgba(252, 46, 15, 0.5) 100%);
            background: -webkit-linear-gradient(top, rgba(226, 112, 104, 0.3) 0%, rgba(252, 46, 15, 0.5) 100%);
            background: linear-gradient(to bottom, rgba(226, 112, 104, 0.3) 0%, rgba(252, 46, 15, 0.5) 100%);
            box-shadow: 0px 0px 3px 0px rgba(0, 0, 0, 0.5);
        }


        .listendiv {
            /*cursor: url('https://www.liveworksheets.com/lwsmaker/images/speakercursor2.cur'), url('https://www.liveworksheets.com/lwsmaker/images/speakercursor2.png'), default;*/
        }

        .floatLayer {
            display: none;
            top: 150px;
            position: fixed;
            width: 500px;
            height: 500px;
            z-index: 36;
            margin-right: auto;
            margin-left: auto;
            right: 0;
            left: 0;
            background-color: #FFFFFF;
            border: 1px solid #666666;
            border-radius: 3px;
            box-shadow: 0px 0px 8px #666666;
            -moz-box-shadow: 0px 0px 8px #666666;
            -webkit-box-shadow: 0px 0px 8px #666666;
        }


        .finishLayer {
            display: none;
            position: absolute;
            width: 500px;
            height: 500px;
            z-index: 36;
            margin-right: auto;
            margin-left: auto;
            right: 0;
            left: 0;
            background-color: #FFFFFF;
            border: 1px solid #666666;
            border-radius: 3px;
            box-shadow: 0px 0px 8px #666666;
            -moz-box-shadow: 0px 0px 8px #666666;
            -webkit-box-shadow: 0px 0px 8px #666666;
        }


        .stylechoosediv {
            display: none;
            position: absolute;
            width: 400px;
            height: 450px;
            z-index: 35;
            background-color: #FFFFFF;
            border: 1px solid #666666;
            border-radius: 3px;
            box-shadow: 0px 0px 8px #666666;
            -moz-box-shadow: 0px 0px 8px #666666;
            -webkit-box-shadow: 0px 0px 8px #666666;
        }


        .audioplayer {
            border-radius: 3px;
            overflow: hidden;
            background: #888888;

        }

        .pButton {
            height: 20px;
            width: 20px;
            border: none;
            background: url('https://files.liveworksheets.com/images/play.png');
            background-size: 80% 80%;
            background-repeat: no-repeat;
            background-position: center;
            float: left;
            outline: none;
            cursor: pointer;

        }


        .timeline {
            width: 150px;
            height: 10px;
            margin-top: 5px;
            float: left;
            border-radius: 15px;
            background: #FFFFFF;
            cursor: pointer;

        }

        .playhead {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-top: 0px;
            background: rgba(0, 0, 0, 1);
            cursor: pointer;

        }

        .transparentaudioplayer {
            cursor: url('https://www.liveworksheets.com/lwsmaker/images/speakercursor2.cur'), url('https://www.liveworksheets.com/lwsmaker/images/speakercursor2.png'), default;
        }


        .wordsearchtable {
            table-layout: fixed;
            width: 100%;
            height: 100%;
            border: 1px solid white;
            border-collapse: collapse;
        }

        .wordsearchtd {
            border: 1px solid white;
            background-color: rgba(14, 185, 237, 0.2);
            cursor: pointer;
        }

        .wordsearchtd:hover {
            background-color: rgba(14, 185, 237, 0.5);
            cursor: pointer;
        }

        .clickedtd {
            border: 1px solid white;
            background-color: rgba(0, 0, 255, 0.3);
            cursor: pointer;
        }

        .rightwordsearchtd {
            border: 1px solid white;
            background-color: rgba(23, 153, 9, 0.4);
            cursor: auto;
        }

        .wrongwordsearchtd {
            border: 1px solid white;
            background-color: rgba(226, 112, 104, 0.4);
            cursor: auto;
        }

    </style>
    <link rel="stylesheet" href="/css/style.css" type="text/css">

    <script language="javascript">
        var mostrandologin = 0;

        function closeLogin() {
            document.getElementById("capalogin").style.display = "none";
            mostrandologin = 0;
        }

        var idiomasdebusquedaordenados = 0;

        function mostrarbusquedaavanzada() {
            $("#capabusquedaavanzada").toggleClass('active');
            if (idiomasdebusquedaordenados == 0) {
                ordenarIdiomasBusqueda();
                idiomasdebusquedaordenados = 1;
            }
        }

        function desplegarmenuteachers() {
            console.log('firing');
            if (document.getElementById("teachersmenu")) {
                $("#teachersmenu").toggleClass('active');
                $("#teachersdropdowntriangle").toggleClass('active');
            }
        }

        var clickedoutsideteachersmenu = function (event) {
            if (document.getElementById('teachersmenu').contains(event.target)) {

            } else {
                desplegarmenuteachers(36);
                window.removeEventListener('click', clickedoutsideteachersmenu, false);
            }
        };

        var clickedoutsidemakeinteractiveworkbooks = function (event) {
            if (document.getElementById('makeinteractiveworkbooksdiv').contains(event.target)) {

            } else {
                desplegarmakeinteractiveworkbooks(30);
                window.removeEventListener('click', clickedoutsidemakeinteractiveworkbooks, false);
            }
        };

        function ordenarIdiomasBusqueda() {
            var opcionesmostradas = 0;
            var selElem = document.getElementById("languagebusqueda");
            var tmpAry = new Array();
            for (var i = 0; i < selElem.options.length; i++) {
                tmpAry[i] = new Array();
                tmpAry[i][0] = selElem.options[i].text;
                tmpAry[i][1] = selElem.options[i].value;
            }
            tmpAry.sort();
            while (selElem.options.length > 0) {
                selElem.options[0] = null;
            }

            for (var i = 0; i < tmpAry.length; i++) {
                if (tmpAry[i][1].toLowerCase() == "") {
                    var op = new Option(tmpAry[i][0], tmpAry[i][1]);
                    selElem.options[0] = op;
                    opcionesmostradas++;
                }
            }


            for (var i = 0; i < tmpAry.length; i++) {
                var op = new Option(tmpAry[i][0], tmpAry[i][1]);
                selElem.options[opcionesmostradas] = op;
                opcionesmostradas++;
            }
            return;
        }

        var numerodemensajesemergentes = 0;

        function mensajeemergente(texto, anchuramensaje, alturamensaje) {
            var elemDiv = document.createElement('div');
            elemDiv.setAttribute("id", "mensajeemergente" + numerodemensajesemergentes);
            elemDiv.style.cssText = ' padding-left: 10px; padding-right: 10px;position:fixed;width:' + anchuramensaje + 'px;height:' + alturamensaje + 'px;z-index: 36000000;top:0;bottom:0;left:0;right:0;margin-top:auto;margin-bottom:auto;margin-left:auto;margin-right:auto; background-color: #FFFFFF;border: 1px solid #999999;border-radius: 0px;box-shadow: 0px 0px 8px #999999;';
            var elhtml = '<div style="position:absolute;top:5px;right:5px;width:15px;height:20px;"><span class="enlace" style="font-size:16px" onclick="ocultarmensajeemergente(' + numerodemensajesemergentes + ')">x</span></div>';
            elhtml = elhtml + '<table width="100%" height="100%"><tr><td valign="middle" align="center">';
            elhtml = elhtml + texto;
            elhtml = elhtml + '</td></tr></table>';
            elemDiv.innerHTML = elhtml;
            document.body.appendChild(elemDiv);
            numerodemensajesemergentes = numerodemensajesemergentes + 1;
        }

        function ocultarmensajeemergente(numero) {
            var element = document.getElementById("mensajeemergente" + numero);
            element.parentNode.removeChild(element);
        }

    </script>
</head>


<body onload="comprobarRequisitos(),mostrarcontenido(), imgLoading()">

<div id="capafondo" class="capafondo" style="z-index:1;position:relative; height: 1521px; width: 1000px;">
    <img id="imagendefondo1" src=""><br>
    <div id="capacanvas" style="z-index:1;position:absolute;top:0px;left:0px">
        <svg id="elsvg" width="1000" height="1411"></svg>
    </div>

    <div id="capacanvas2" style="z-index:2;position:absolute;top:0px;left:0px">
        <svg id="elsvgdefinitivo" width="1000" height="1411"></svg>
    </div>

    <div id="capanotas" class="capanotas" style="display:none;z-index:10;position:absolute;top:0px;left:0px">
    </div>

    <div id="capa1" style="z-index:2">
    </div>
    <div onclick="heTerminado()" class="finishbutton" align="center" valign="middle" id="capafinish" style="top:1431px">
        <b>Finish!!</b>
    </div>
    <div id="capataparworksheet" class="capataparworksheet"
         style="z-index:20;position:absolute;top:0px;left:0px;width:100%;height:100%;background-color:black;opacity:0.5;display:none"></div>
</div>
</body>
</html>
